"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/me/route";
exports.ids = ["app/api/auth/me/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fme%2Froute&page=%2Fapi%2Fauth%2Fme%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fme%2Froute.ts&appDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fme%2Froute&page=%2Fapi%2Fauth%2Fme%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fme%2Froute.ts&appDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_ameralyasin_Desktop_cam_analysis_app_api_auth_me_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/me/route.ts */ \"(rsc)/./app/api/auth/me/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/me/route\",\n        pathname: \"/api/auth/me\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/me/route\"\n    },\n    resolvedPagePath: \"/Users/ameralyasin/Desktop/cam analysis/app/api/auth/me/route.ts\",\n    nextConfigOutput,\n    userland: _Users_ameralyasin_Desktop_cam_analysis_app_api_auth_me_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/auth/me/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGbWUlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZtZSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZtZSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmFtZXJhbHlhc2luJTJGRGVza3RvcCUyRmNhbSUyMGFuYWx5c2lzJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmFtZXJhbHlhc2luJTJGRGVza3RvcCUyRmNhbSUyMGFuYWx5c2lzJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2dCO0FBQzdGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDNko7O0FBRTdKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2FtLWFuYWx5c2lzLz9kYTkwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9hbWVyYWx5YXNpbi9EZXNrdG9wL2NhbSBhbmFseXNpcy9hcHAvYXBpL2F1dGgvbWUvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2F1dGgvbWUvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hdXRoL21lXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hdXRoL21lL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2FtZXJhbHlhc2luL0Rlc2t0b3AvY2FtIGFuYWx5c2lzL2FwcC9hcGkvYXV0aC9tZS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hdXRoL21lL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fme%2Froute&page=%2Fapi%2Fauth%2Fme%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fme%2Froute.ts&appDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/me/route.ts":
/*!**********************************!*\
  !*** ./app/api/auth/me/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/auth */ \"(rsc)/./lib/auth.ts\");\n\n\nasync function GET(req) {\n    const session = (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.getSessionFromRequest)(req);\n    if (!session) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            ok: false,\n            error: \"Unauthorized.\"\n        }, {\n            status: 401\n        });\n    }\n    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n        ok: true,\n        user: {\n            username: session.username,\n            role: session.role\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvbWUvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTJDO0FBQ2tCO0FBRXRELGVBQWVFLElBQUlDLEdBQVk7SUFDcEMsTUFBTUMsVUFBVUgsZ0VBQXFCQSxDQUFDRTtJQUN0QyxJQUFJLENBQUNDLFNBQVM7UUFDWixPQUFPSixrRkFBWUEsQ0FBQ0ssSUFBSSxDQUFDO1lBQUVDLElBQUk7WUFBT0MsT0FBTztRQUFnQixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUNoRjtJQUNBLE9BQU9SLGtGQUFZQSxDQUFDSyxJQUFJLENBQUM7UUFDdkJDLElBQUk7UUFDSkcsTUFBTTtZQUFFQyxVQUFVTixRQUFRTSxRQUFRO1lBQUVDLE1BQU1QLFFBQVFPLElBQUk7UUFBQztJQUN6RDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2FtLWFuYWx5c2lzLy4vYXBwL2FwaS9hdXRoL21lL3JvdXRlLnRzP2M3MjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgeyBnZXRTZXNzaW9uRnJvbVJlcXVlc3QgfSBmcm9tIFwiLi4vLi4vLi4vLi4vbGliL2F1dGhcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXE6IFJlcXVlc3QpIHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGdldFNlc3Npb25Gcm9tUmVxdWVzdChyZXEpO1xuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBvazogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZC5cIiB9LCB7IHN0YXR1czogNDAxIH0pO1xuICB9XG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgb2s6IHRydWUsXG4gICAgdXNlcjogeyB1c2VybmFtZTogc2Vzc2lvbi51c2VybmFtZSwgcm9sZTogc2Vzc2lvbi5yb2xlIH1cbiAgfSk7XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZ2V0U2Vzc2lvbkZyb21SZXF1ZXN0IiwiR0VUIiwicmVxIiwic2Vzc2lvbiIsImpzb24iLCJvayIsImVycm9yIiwic3RhdHVzIiwidXNlciIsInVzZXJuYW1lIiwicm9sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/me/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createSession: () => (/* binding */ createSession),\n/* harmony export */   getSessionCookieName: () => (/* binding */ getSessionCookieName),\n/* harmony export */   getSessionFromRequest: () => (/* binding */ getSessionFromRequest),\n/* harmony export */   getSessionTtlSeconds: () => (/* binding */ getSessionTtlSeconds),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   parseCookies: () => (/* binding */ parseCookies),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword),\n/* harmony export */   verifySession: () => (/* binding */ verifySession)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nconst SESSION_COOKIE = \"session\";\nconst SESSION_TTL_SECONDS = 60 * 60 * 12;\nconst getSecret = ()=>process.env.AUTH_SECRET || \"dev-secret\";\nconst base64urlEncode = (value)=>Buffer.from(value).toString(\"base64url\");\nconst base64urlDecode = (value)=>Buffer.from(value, \"base64url\").toString(\"utf8\");\nconst sign = (value)=>crypto__WEBPACK_IMPORTED_MODULE_0___default().createHmac(\"sha256\", getSecret()).update(value).digest(\"base64url\");\nfunction createSession(username, role) {\n    const exp = Date.now() + SESSION_TTL_SECONDS * 1000;\n    const payload = {\n        username,\n        role,\n        exp\n    };\n    const payloadEncoded = base64urlEncode(JSON.stringify(payload));\n    const token = `${payloadEncoded}.${sign(payloadEncoded)}`;\n    return {\n        token,\n        exp\n    };\n}\nfunction verifySession(token) {\n    if (!token) return null;\n    const [payloadEncoded, signature] = token.split(\".\");\n    if (!payloadEncoded || !signature) return null;\n    if (sign(payloadEncoded) !== signature) return null;\n    try {\n        const payload = JSON.parse(base64urlDecode(payloadEncoded));\n        if (!payload?.exp || Date.now() > payload.exp) return null;\n        return payload;\n    } catch  {\n        return null;\n    }\n}\nfunction parseCookies(header) {\n    if (!header) return {};\n    return header.split(\";\").reduce((acc, part)=>{\n        const [rawKey, ...rawValue] = part.trim().split(\"=\");\n        if (!rawKey) return acc;\n        acc[rawKey] = decodeURIComponent(rawValue.join(\"=\"));\n        return acc;\n    }, {});\n}\nfunction getSessionFromRequest(req) {\n    const cookies = parseCookies(req.headers.get(\"cookie\"));\n    return verifySession(cookies[SESSION_COOKIE]);\n}\nfunction getSessionCookieName() {\n    return SESSION_COOKIE;\n}\nfunction getSessionTtlSeconds() {\n    return SESSION_TTL_SECONDS;\n}\nfunction hashPassword(password) {\n    const salt = crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(16).toString(\"hex\");\n    const iterations = 120000;\n    const hash = crypto__WEBPACK_IMPORTED_MODULE_0___default().pbkdf2Sync(password, salt, iterations, 32, \"sha256\").toString(\"hex\");\n    return `pbkdf2$${iterations}$${salt}$${hash}`;\n}\nfunction verifyPassword(password, stored) {\n    const [scheme, iterationsRaw, salt, hash] = stored.split(\"$\");\n    if (scheme !== \"pbkdf2\" || !iterationsRaw || !salt || !hash) return false;\n    const iterations = Number(iterationsRaw);\n    if (!Number.isFinite(iterations) || iterations <= 0) return false;\n    const derived = crypto__WEBPACK_IMPORTED_MODULE_0___default().pbkdf2Sync(password, salt, iterations, 32, \"sha256\").toString(\"hex\");\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().timingSafeEqual(Buffer.from(hash, \"hex\"), Buffer.from(derived, \"hex\"));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUk0QixXQUFXLFlBQVksQ0FBQ0MsaUJBQWlCLENBQUNSLFFBQVEsQ0FBQ0csTUFBTSxPQUFPO0lBQ3BFLE1BQU1ELGFBQWFPLE9BQU9EO0lBQzFCLElBQUksQ0FBQ0MsT0FBT0MsUUFBUSxDQUFDUixlQUFlQSxjQUFjLEdBQUcsT0FBTztJQUM1RCxNQUFNUyxVQUFVOUQsd0RBQ0gsQ0FBQ2tELFVBQVVDLE1BQU1FLFlBQVksSUFBSSxVQUMzQzFDLFFBQVEsQ0FBQztJQUNaLE9BQU9YLDZEQUFzQixDQUFDUyxPQUFPQyxJQUFJLENBQUM0QyxNQUFNLFFBQVE3QyxPQUFPQyxJQUFJLENBQUNvRCxTQUFTO0FBQy9FIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2FtLWFuYWx5c2lzLy4vbGliL2F1dGgudHM/YmY3ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY3J5cHRvIGZyb20gXCJjcnlwdG9cIjtcblxuZXhwb3J0IHR5cGUgVXNlclJvbGUgPSBcImFkbWluXCIgfCBcInVzZXJcIjtcblxudHlwZSBTZXNzaW9uUGF5bG9hZCA9IHtcbiAgdXNlcm5hbWU6IHN0cmluZztcbiAgcm9sZTogVXNlclJvbGU7XG4gIGV4cDogbnVtYmVyO1xufTtcblxuY29uc3QgU0VTU0lPTl9DT09LSUUgPSBcInNlc3Npb25cIjtcbmNvbnN0IFNFU1NJT05fVFRMX1NFQ09ORFMgPSA2MCAqIDYwICogMTI7XG5cbmNvbnN0IGdldFNlY3JldCA9ICgpID0+IHByb2Nlc3MuZW52LkFVVEhfU0VDUkVUIHx8IFwiZGV2LXNlY3JldFwiO1xuXG5jb25zdCBiYXNlNjR1cmxFbmNvZGUgPSAodmFsdWU6IHN0cmluZykgPT4gQnVmZmVyLmZyb20odmFsdWUpLnRvU3RyaW5nKFwiYmFzZTY0dXJsXCIpO1xuY29uc3QgYmFzZTY0dXJsRGVjb2RlID0gKHZhbHVlOiBzdHJpbmcpID0+IEJ1ZmZlci5mcm9tKHZhbHVlLCBcImJhc2U2NHVybFwiKS50b1N0cmluZyhcInV0ZjhcIik7XG5cbmNvbnN0IHNpZ24gPSAodmFsdWU6IHN0cmluZykgPT5cbiAgY3J5cHRvLmNyZWF0ZUhtYWMoXCJzaGEyNTZcIiwgZ2V0U2VjcmV0KCkpLnVwZGF0ZSh2YWx1ZSkuZGlnZXN0KFwiYmFzZTY0dXJsXCIpO1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2Vzc2lvbih1c2VybmFtZTogc3RyaW5nLCByb2xlOiBVc2VyUm9sZSkge1xuICBjb25zdCBleHAgPSBEYXRlLm5vdygpICsgU0VTU0lPTl9UVExfU0VDT05EUyAqIDEwMDA7XG4gIGNvbnN0IHBheWxvYWQ6IFNlc3Npb25QYXlsb2FkID0geyB1c2VybmFtZSwgcm9sZSwgZXhwIH07XG4gIGNvbnN0IHBheWxvYWRFbmNvZGVkID0gYmFzZTY0dXJsRW5jb2RlKEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKTtcbiAgY29uc3QgdG9rZW4gPSBgJHtwYXlsb2FkRW5jb2RlZH0uJHtzaWduKHBheWxvYWRFbmNvZGVkKX1gO1xuICByZXR1cm4geyB0b2tlbiwgZXhwIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2ZXJpZnlTZXNzaW9uKHRva2VuOiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcbiAgaWYgKCF0b2tlbikgcmV0dXJuIG51bGw7XG4gIGNvbnN0IFtwYXlsb2FkRW5jb2RlZCwgc2lnbmF0dXJlXSA9IHRva2VuLnNwbGl0KFwiLlwiKTtcbiAgaWYgKCFwYXlsb2FkRW5jb2RlZCB8fCAhc2lnbmF0dXJlKSByZXR1cm4gbnVsbDtcbiAgaWYgKHNpZ24ocGF5bG9hZEVuY29kZWQpICE9PSBzaWduYXR1cmUpIHJldHVybiBudWxsO1xuICB0cnkge1xuICAgIGNvbnN0IHBheWxvYWQgPSBKU09OLnBhcnNlKGJhc2U2NHVybERlY29kZShwYXlsb2FkRW5jb2RlZCkpIGFzIFNlc3Npb25QYXlsb2FkO1xuICAgIGlmICghcGF5bG9hZD8uZXhwIHx8IERhdGUubm93KCkgPiBwYXlsb2FkLmV4cCkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIHBheWxvYWQ7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUNvb2tpZXMoaGVhZGVyOiBzdHJpbmcgfCBudWxsKSB7XG4gIGlmICghaGVhZGVyKSByZXR1cm4ge307XG4gIHJldHVybiBoZWFkZXIuc3BsaXQoXCI7XCIpLnJlZHVjZSgoYWNjLCBwYXJ0KSA9PiB7XG4gICAgY29uc3QgW3Jhd0tleSwgLi4ucmF3VmFsdWVdID0gcGFydC50cmltKCkuc3BsaXQoXCI9XCIpO1xuICAgIGlmICghcmF3S2V5KSByZXR1cm4gYWNjO1xuICAgIGFjY1tyYXdLZXldID0gZGVjb2RlVVJJQ29tcG9uZW50KHJhd1ZhbHVlLmpvaW4oXCI9XCIpKTtcbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNlc3Npb25Gcm9tUmVxdWVzdChyZXE6IFJlcXVlc3QpIHtcbiAgY29uc3QgY29va2llcyA9IHBhcnNlQ29va2llcyhyZXEuaGVhZGVycy5nZXQoXCJjb29raWVcIikpO1xuICByZXR1cm4gdmVyaWZ5U2Vzc2lvbihjb29raWVzW1NFU1NJT05fQ09PS0lFXSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXNzaW9uQ29va2llTmFtZSgpIHtcbiAgcmV0dXJuIFNFU1NJT05fQ09PS0lFO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2Vzc2lvblR0bFNlY29uZHMoKSB7XG4gIHJldHVybiBTRVNTSU9OX1RUTF9TRUNPTkRTO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzaFBhc3N3b3JkKHBhc3N3b3JkOiBzdHJpbmcpIHtcbiAgY29uc3Qgc2FsdCA9IGNyeXB0by5yYW5kb21CeXRlcygxNikudG9TdHJpbmcoXCJoZXhcIik7XG4gIGNvbnN0IGl0ZXJhdGlvbnMgPSAxMjAwMDA7XG4gIGNvbnN0IGhhc2ggPSBjcnlwdG9cbiAgICAucGJrZGYyU3luYyhwYXNzd29yZCwgc2FsdCwgaXRlcmF0aW9ucywgMzIsIFwic2hhMjU2XCIpXG4gICAgLnRvU3RyaW5nKFwiaGV4XCIpO1xuICByZXR1cm4gYHBia2RmMiQke2l0ZXJhdGlvbnN9JCR7c2FsdH0kJHtoYXNofWA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2ZXJpZnlQYXNzd29yZChwYXNzd29yZDogc3RyaW5nLCBzdG9yZWQ6IHN0cmluZykge1xuICBjb25zdCBbc2NoZW1lLCBpdGVyYXRpb25zUmF3LCBzYWx0LCBoYXNoXSA9IHN0b3JlZC5zcGxpdChcIiRcIik7XG4gIGlmIChzY2hlbWUgIT09IFwicGJrZGYyXCIgfHwgIWl0ZXJhdGlvbnNSYXcgfHwgIXNhbHQgfHwgIWhhc2gpIHJldHVybiBmYWxzZTtcbiAgY29uc3QgaXRlcmF0aW9ucyA9IE51bWJlcihpdGVyYXRpb25zUmF3KTtcbiAgaWYgKCFOdW1iZXIuaXNGaW5pdGUoaXRlcmF0aW9ucykgfHwgaXRlcmF0aW9ucyA8PSAwKSByZXR1cm4gZmFsc2U7XG4gIGNvbnN0IGRlcml2ZWQgPSBjcnlwdG9cbiAgICAucGJrZGYyU3luYyhwYXNzd29yZCwgc2FsdCwgaXRlcmF0aW9ucywgMzIsIFwic2hhMjU2XCIpXG4gICAgLnRvU3RyaW5nKFwiaGV4XCIpO1xuICByZXR1cm4gY3J5cHRvLnRpbWluZ1NhZmVFcXVhbChCdWZmZXIuZnJvbShoYXNoLCBcImhleFwiKSwgQnVmZmVyLmZyb20oZGVyaXZlZCwgXCJoZXhcIikpO1xufVxuIl0sIm5hbWVzIjpbImNyeXB0byIsIlNFU1NJT05fQ09PS0lFIiwiU0VTU0lPTl9UVExfU0VDT05EUyIsImdldFNlY3JldCIsInByb2Nlc3MiLCJlbnYiLCJBVVRIX1NFQ1JFVCIsImJhc2U2NHVybEVuY29kZSIsInZhbHVlIiwiQnVmZmVyIiwiZnJvbSIsInRvU3RyaW5nIiwiYmFzZTY0dXJsRGVjb2RlIiwic2lnbiIsImNyZWF0ZUhtYWMiLCJ1cGRhdGUiLCJkaWdlc3QiLCJjcmVhdGVTZXNzaW9uIiwidXNlcm5hbWUiLCJyb2xlIiwiZXhwIiwiRGF0ZSIsIm5vdyIsInBheWxvYWQiLCJwYXlsb2FkRW5jb2RlZCIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0b2tlbiIsInZlcmlmeVNlc3Npb24iLCJzaWduYXR1cmUiLCJzcGxpdCIsInBhcnNlIiwicGFyc2VDb29raWVzIiwiaGVhZGVyIiwicmVkdWNlIiwiYWNjIiwicGFydCIsInJhd0tleSIsInJhd1ZhbHVlIiwidHJpbSIsImRlY29kZVVSSUNvbXBvbmVudCIsImpvaW4iLCJnZXRTZXNzaW9uRnJvbVJlcXVlc3QiLCJyZXEiLCJjb29raWVzIiwiaGVhZGVycyIsImdldCIsImdldFNlc3Npb25Db29raWVOYW1lIiwiZ2V0U2Vzc2lvblR0bFNlY29uZHMiLCJoYXNoUGFzc3dvcmQiLCJwYXNzd29yZCIsInNhbHQiLCJyYW5kb21CeXRlcyIsIml0ZXJhdGlvbnMiLCJoYXNoIiwicGJrZGYyU3luYyIsInZlcmlmeVBhc3N3b3JkIiwic3RvcmVkIiwic2NoZW1lIiwiaXRlcmF0aW9uc1JhdyIsIk51bWJlciIsImlzRmluaXRlIiwiZGVyaXZlZCIsInRpbWluZ1NhZmVFcXVhbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fme%2Froute&page=%2Fapi%2Fauth%2Fme%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fme%2Froute.ts&appDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();