"use strict";(()=>{var e={};e.id=183,e.ids=[183],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8732:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>g,originalPathname:()=>y,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>v,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>f});var i={};t.r(i),t.d(i,{POST:()=>p,runtime:()=>c});var a=t(5419),n=t(9108),o=t(9678),s=t(8070),u=t(7802);let c="nodejs";async function p(e){let r=await e.json().catch(()=>({})),t="string"==typeof r.ip?r.ip.trim():"",i="string"==typeof r.name?r.name.trim():"",a=function(e){if(!e)return null;let r=e.trim().toLowerCase();return["ai_box","aibox","ai-box","ai"].includes(r)?"ai_box":["camera","cam"].includes(r)?"camera":null}(r.deviceType??""),n="string"==typeof r.username?r.username:"",o="string"==typeof r.password?r.password:"";if(!t||!a)return s.Z.json({ok:!1,error:"Missing ip or deviceType."},{status:400});let c=(0,u.z)(),p=await c.query(`insert into cameras (ip, name, device_type)
     values ($1, $2, $3)
     on conflict (ip)
     do update set
       name = excluded.name,
       device_type = excluded.device_type
     returning id`,[t,i||null,a]),d=process.env.UNV_SERVER_URL,l=null;if(d)try{let e=await fetch(`${d.replace(/\/$/,"")}/devices/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip:t,deviceType:a,username:n,password:o})}),r=await e.json().catch(()=>({}));l={ok:!!r.ok,error:r.error}}catch(e){l={ok:!1,error:e.message}}return s.Z.json({ok:!0,id:p.rows[0]?.id,server:l})}let d=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/device/register/route",pathname:"/api/device/register",filename:"route",bundlePath:"app/api/device/register/route"},resolvedPagePath:"/Users/ameralyasin/Desktop/cam analysis/app/api/device/register/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:v,headerHooks:g,staticGenerationBailout:f}=d,y="/api/device/register/route";function h(){return(0,o.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:m})}},7802:(e,r,t)=>{t.d(r,{z:()=>n});let i=require("pg"),a=null;function n(){if(!a){let e=process.env.DATABASE_URL;if(!e)throw Error("DATABASE_URL is not set.");a=new i.Pool({connectionString:e})}return a}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[638,206],()=>t(8732));module.exports=i})();