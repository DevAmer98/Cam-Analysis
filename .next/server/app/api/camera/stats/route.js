"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/camera/stats/route";
exports.ids = ["app/api/camera/stats/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcamera%2Fstats%2Froute&page=%2Fapi%2Fcamera%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcamera%2Fstats%2Froute.ts&appDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcamera%2Fstats%2Froute&page=%2Fapi%2Fcamera%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcamera%2Fstats%2Froute.ts&appDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_ameralyasin_Desktop_cam_analysis_app_api_camera_stats_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/camera/stats/route.ts */ \"(rsc)/./app/api/camera/stats/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/camera/stats/route\",\n        pathname: \"/api/camera/stats\",\n        filename: \"route\",\n        bundlePath: \"app/api/camera/stats/route\"\n    },\n    resolvedPagePath: \"/Users/ameralyasin/Desktop/cam analysis/app/api/camera/stats/route.ts\",\n    nextConfigOutput,\n    userland: _Users_ameralyasin_Desktop_cam_analysis_app_api_camera_stats_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/camera/stats/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjYW1lcmElMkZzdGF0cyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGY2FtZXJhJTJGc3RhdHMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZjYW1lcmElMkZzdGF0cyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmFtZXJhbHlhc2luJTJGRGVza3RvcCUyRmNhbSUyMGFuYWx5c2lzJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmFtZXJhbHlhc2luJTJGRGVza3RvcCUyRmNhbSUyMGFuYWx5c2lzJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3FCO0FBQ2xHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDNko7O0FBRTdKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2FtLWFuYWx5c2lzLz8xM2EyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9hbWVyYWx5YXNpbi9EZXNrdG9wL2NhbSBhbmFseXNpcy9hcHAvYXBpL2NhbWVyYS9zdGF0cy9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2FtZXJhL3N0YXRzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2FtZXJhL3N0YXRzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jYW1lcmEvc3RhdHMvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvYW1lcmFseWFzaW4vRGVza3RvcC9jYW0gYW5hbHlzaXMvYXBwL2FwaS9jYW1lcmEvc3RhdHMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2FtZXJhL3N0YXRzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcamera%2Fstats%2Froute&page=%2Fapi%2Fcamera%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcamera%2Fstats%2Froute.ts&appDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/camera/stats/route.ts":
/*!***************************************!*\
  !*** ./app/api/camera/stats/route.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/db */ \"(rsc)/./lib/db.ts\");\n\n\nasync function GET(req) {\n    const url = new URL(req.url);\n    const ip = url.searchParams.get(\"ip\");\n    const day = url.searchParams.get(\"day\");\n    const dayParam = day ? day.trim() : \"\";\n    if (!ip) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            ok: false,\n            error: \"Missing ip.\"\n        }, {\n            status: 400\n        });\n    }\n    const db = (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.getDbPool)();\n    const cameraResult = await db.query(\"select id from cameras where ip = $1\", [\n        ip\n    ]);\n    const cameraId = cameraResult.rows[0]?.id;\n    if (!cameraId) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            ok: true,\n            stats: {\n                ip,\n                lastEventAt: null,\n                channels: []\n            }\n        });\n    }\n    const peopleWhere = dayParam ? \"camera_id = $1 and day = $2::date\" : \"camera_id = $1 and day >= current_date\";\n    const peopleParams = dayParam ? [\n        cameraId,\n        dayParam\n    ] : [\n        cameraId\n    ];\n    const peopleRows = await db.query(`select channel_no,\n            coalesce(sum(in_count), 0) as people_in,\n            coalesce(sum(out_count), 0) as people_out,\n            max(day) as last_people_event\n     from counting_stats_daily\n     where ${peopleWhere}\n     group by channel_no`, peopleParams);\n    const faceWhere = dayParam ? \"camera_id = $1 and bucket_start >= $2::date and bucket_start < $2::date + interval '1 day'\" : \"camera_id = $1\";\n    const faceParams = dayParam ? [\n        cameraId,\n        dayParam\n    ] : [\n        cameraId\n    ];\n    const faceRows = await db.query(`select channel_no,\n            max(bucket_start) as last_face_event\n     from face_stats_hourly\n     where ${faceWhere}\n     group by channel_no`, faceParams);\n    const attributeWhere = dayParam ? \"camera_id = $1 and day = $2::date\" : \"camera_id = $1 and day >= current_date\";\n    const attributeParams = dayParam ? [\n        cameraId,\n        dayParam\n    ] : [\n        cameraId\n    ];\n    const attributeRows = await db.query(`select channel_no,\n            coalesce(sum(total), 0) as faces_total,\n            coalesce(sum(male), 0) as male_count,\n            coalesce(sum(female), 0) as female_count,\n            coalesce(sum(unknown_gender), 0) as gender_unknown,\n            coalesce(sum(glasses_yes), 0) as glasses_yes,\n            coalesce(sum(glasses_no), 0) as glasses_no,\n            coalesce(sum(glasses_unknown), 0) as glasses_unknown,\n            coalesce(sum(age_child), 0) as child_count,\n            coalesce(sum(age_teen), 0) as teen_count,\n            coalesce(sum(age_young_adult), 0) as young_count,\n            coalesce(sum(age_middle_age), 0) as middle_count,\n            coalesce(sum(age_senior), 0) as senior_count,\n            coalesce(sum(age_unknown), 0) as age_unknown_count\n     from face_stats_daily\n     where ${attributeWhere}\n     group by channel_no`, attributeParams);\n    const channelMap = new Map();\n    for (const row of peopleRows.rows){\n        const channelNo = Number(row.channel_no);\n        channelMap.set(channelNo, {\n            peopleIn: Number(row.people_in ?? 0),\n            peopleOut: Number(row.people_out ?? 0),\n            faceEvents: 0,\n            facesDetected: 0,\n            gender: {\n                male: 0,\n                female: 0,\n                unknown: 0\n            },\n            age: {\n                avg: null\n            },\n            glasses: {\n                yes: 0,\n                no: 0,\n                unknown: 0\n            },\n            lastEventAt: row.last_people_event ? new Date(row.last_people_event).toISOString() : null\n        });\n    }\n    for (const row of faceRows.rows){\n        const channelNo = Number(row.channel_no);\n        const existing = channelMap.get(channelNo) ?? {\n            peopleIn: 0,\n            peopleOut: 0,\n            faceEvents: 0,\n            facesDetected: 0,\n            gender: {\n                male: 0,\n                female: 0,\n                unknown: 0\n            },\n            age: {\n                avg: null\n            },\n            glasses: {\n                yes: 0,\n                no: 0,\n                unknown: 0\n            },\n            lastEventAt: null\n        };\n        const lastFace = row.last_face_event ? new Date(row.last_face_event).toISOString() : null;\n        channelMap.set(channelNo, {\n            peopleIn: existing.peopleIn,\n            peopleOut: existing.peopleOut,\n            faceEvents: existing.faceEvents,\n            facesDetected: existing.facesDetected,\n            gender: existing.gender,\n            age: existing.age,\n            glasses: existing.glasses,\n            lastEventAt: existing.lastEventAt || lastFace\n        });\n    }\n    for (const row of attributeRows.rows){\n        const channelNo = Number(row.channel_no);\n        const existing = channelMap.get(channelNo) ?? {\n            peopleIn: 0,\n            peopleOut: 0,\n            faceEvents: 0,\n            facesDetected: 0,\n            gender: {\n                male: 0,\n                female: 0,\n                unknown: 0\n            },\n            age: {\n                avg: null\n            },\n            glasses: {\n                yes: 0,\n                no: 0,\n                unknown: 0\n            },\n            lastEventAt: null\n        };\n        const child = Number(row.child_count ?? 0);\n        const teen = Number(row.teen_count ?? 0);\n        const young = Number(row.young_count ?? 0);\n        const middle = Number(row.middle_count ?? 0);\n        const senior = Number(row.senior_count ?? 0);\n        const knownAges = child + teen + young + middle + senior;\n        const avgAge = knownAges > 0 ? (child * 6 + teen * 16 + young * 30 + middle * 50 + senior * 70) / knownAges : null;\n        const facesTotal = Number(row.faces_total ?? 0);\n        channelMap.set(channelNo, {\n            ...existing,\n            faceEvents: facesTotal,\n            facesDetected: facesTotal,\n            gender: {\n                male: Number(row.male_count ?? 0),\n                female: Number(row.female_count ?? 0),\n                unknown: Number(row.gender_unknown ?? 0)\n            },\n            age: {\n                avg: avgAge\n            },\n            glasses: {\n                yes: Number(row.glasses_yes ?? 0),\n                no: Number(row.glasses_no ?? 0),\n                unknown: Number(row.glasses_unknown ?? 0)\n            }\n        });\n    }\n    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n        ok: true,\n        stats: {\n            ip,\n            lastEventAt: null,\n            channels: Array.from(channelMap.entries()).map(([channelId, stats])=>({\n                    channelId: String(channelId),\n                    stats\n                }))\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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L2FwaS9jYW1lcmEvc3RhdHMvcm91dGUudHM/NTUyYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IGdldERiUG9vbCB9IGZyb20gXCIuLi8uLi8uLi8uLi9saWIvZGJcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXE6IFJlcXVlc3QpIHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChyZXEudXJsKTtcbiAgY29uc3QgaXAgPSB1cmwuc2VhcmNoUGFyYW1zLmdldChcImlwXCIpO1xuICBjb25zdCBkYXkgPSB1cmwuc2VhcmNoUGFyYW1zLmdldChcImRheVwiKTtcbiAgY29uc3QgZGF5UGFyYW0gPSBkYXkgPyBkYXkudHJpbSgpIDogXCJcIjtcbiAgaWYgKCFpcCkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9rOiBmYWxzZSwgZXJyb3I6IFwiTWlzc2luZyBpcC5cIiB9LCB7IHN0YXR1czogNDAwIH0pO1xuICB9XG4gIGNvbnN0IGRiID0gZ2V0RGJQb29sKCk7XG4gIGNvbnN0IGNhbWVyYVJlc3VsdCA9IGF3YWl0IGRiLnF1ZXJ5KFwic2VsZWN0IGlkIGZyb20gY2FtZXJhcyB3aGVyZSBpcCA9ICQxXCIsIFtpcF0pO1xuICBjb25zdCBjYW1lcmFJZCA9IGNhbWVyYVJlc3VsdC5yb3dzWzBdPy5pZCBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gIGlmICghY2FtZXJhSWQpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgb2s6IHRydWUsXG4gICAgICBzdGF0czogeyBpcCwgbGFzdEV2ZW50QXQ6IG51bGwsIGNoYW5uZWxzOiBbXSB9XG4gICAgfSk7XG4gIH1cblxuICBjb25zdCBwZW9wbGVXaGVyZSA9IGRheVBhcmFtXG4gICAgPyBcImNhbWVyYV9pZCA9ICQxIGFuZCBkYXkgPSAkMjo6ZGF0ZVwiXG4gICAgOiBcImNhbWVyYV9pZCA9ICQxIGFuZCBkYXkgPj0gY3VycmVudF9kYXRlXCI7XG4gIGNvbnN0IHBlb3BsZVBhcmFtcyA9IGRheVBhcmFtID8gW2NhbWVyYUlkLCBkYXlQYXJhbV0gOiBbY2FtZXJhSWRdO1xuICBjb25zdCBwZW9wbGVSb3dzID0gYXdhaXQgZGIucXVlcnkoXG4gICAgYHNlbGVjdCBjaGFubmVsX25vLFxuICAgICAgICAgICAgY29hbGVzY2Uoc3VtKGluX2NvdW50KSwgMCkgYXMgcGVvcGxlX2luLFxuICAgICAgICAgICAgY29hbGVzY2Uoc3VtKG91dF9jb3VudCksIDApIGFzIHBlb3BsZV9vdXQsXG4gICAgICAgICAgICBtYXgoZGF5KSBhcyBsYXN0X3Blb3BsZV9ldmVudFxuICAgICBmcm9tIGNvdW50aW5nX3N0YXRzX2RhaWx5XG4gICAgIHdoZXJlICR7cGVvcGxlV2hlcmV9XG4gICAgIGdyb3VwIGJ5IGNoYW5uZWxfbm9gLFxuICAgIHBlb3BsZVBhcmFtc1xuICApO1xuXG4gIGNvbnN0IGZhY2VXaGVyZSA9IGRheVBhcmFtXG4gICAgPyBcImNhbWVyYV9pZCA9ICQxIGFuZCBidWNrZXRfc3RhcnQgPj0gJDI6OmRhdGUgYW5kIGJ1Y2tldF9zdGFydCA8ICQyOjpkYXRlICsgaW50ZXJ2YWwgJzEgZGF5J1wiXG4gICAgOiBcImNhbWVyYV9pZCA9ICQxXCI7XG4gIGNvbnN0IGZhY2VQYXJhbXMgPSBkYXlQYXJhbSA/IFtjYW1lcmFJZCwgZGF5UGFyYW1dIDogW2NhbWVyYUlkXTtcbiAgY29uc3QgZmFjZVJvd3MgPSBhd2FpdCBkYi5xdWVyeShcbiAgICBgc2VsZWN0IGNoYW5uZWxfbm8sXG4gICAgICAgICAgICBtYXgoYnVja2V0X3N0YXJ0KSBhcyBsYXN0X2ZhY2VfZXZlbnRcbiAgICAgZnJvbSBmYWNlX3N0YXRzX2hvdXJseVxuICAgICB3aGVyZSAke2ZhY2VXaGVyZX1cbiAgICAgZ3JvdXAgYnkgY2hhbm5lbF9ub2AsXG4gICAgZmFjZVBhcmFtc1xuICApO1xuXG4gIGNvbnN0IGF0dHJpYnV0ZVdoZXJlID0gZGF5UGFyYW1cbiAgICA/IFwiY2FtZXJhX2lkID0gJDEgYW5kIGRheSA9ICQyOjpkYXRlXCJcbiAgICA6IFwiY2FtZXJhX2lkID0gJDEgYW5kIGRheSA+PSBjdXJyZW50X2RhdGVcIjtcbiAgY29uc3QgYXR0cmlidXRlUGFyYW1zID0gZGF5UGFyYW0gPyBbY2FtZXJhSWQsIGRheVBhcmFtXSA6IFtjYW1lcmFJZF07XG4gIGNvbnN0IGF0dHJpYnV0ZVJvd3MgPSBhd2FpdCBkYi5xdWVyeShcbiAgICBgc2VsZWN0IGNoYW5uZWxfbm8sXG4gICAgICAgICAgICBjb2FsZXNjZShzdW0odG90YWwpLCAwKSBhcyBmYWNlc190b3RhbCxcbiAgICAgICAgICAgIGNvYWxlc2NlKHN1bShtYWxlKSwgMCkgYXMgbWFsZV9jb3VudCxcbiAgICAgICAgICAgIGNvYWxlc2NlKHN1bShmZW1hbGUpLCAwKSBhcyBmZW1hbGVfY291bnQsXG4gICAgICAgICAgICBjb2FsZXNjZShzdW0odW5rbm93bl9nZW5kZXIpLCAwKSBhcyBnZW5kZXJfdW5rbm93bixcbiAgICAgICAgICAgIGNvYWxlc2NlKHN1bShnbGFzc2VzX3llcyksIDApIGFzIGdsYXNzZXNfeWVzLFxuICAgICAgICAgICAgY29hbGVzY2Uoc3VtKGdsYXNzZXNfbm8pLCAwKSBhcyBnbGFzc2VzX25vLFxuICAgICAgICAgICAgY29hbGVzY2Uoc3VtKGdsYXNzZXNfdW5rbm93biksIDApIGFzIGdsYXNzZXNfdW5rbm93bixcbiAgICAgICAgICAgIGNvYWxlc2NlKHN1bShhZ2VfY2hpbGQpLCAwKSBhcyBjaGlsZF9jb3VudCxcbiAgICAgICAgICAgIGNvYWxlc2NlKHN1bShhZ2VfdGVlbiksIDApIGFzIHRlZW5fY291bnQsXG4gICAgICAgICAgICBjb2FsZXNjZShzdW0oYWdlX3lvdW5nX2FkdWx0KSwgMCkgYXMgeW91bmdfY291bnQsXG4gICAgICAgICAgICBjb2FsZXNjZShzdW0oYWdlX21pZGRsZV9hZ2UpLCAwKSBhcyBtaWRkbGVfY291bnQsXG4gICAgICAgICAgICBjb2FsZXNjZShzdW0oYWdlX3NlbmlvciksIDApIGFzIHNlbmlvcl9jb3VudCxcbiAgICAgICAgICAgIGNvYWxlc2NlKHN1bShhZ2VfdW5rbm93biksIDApIGFzIGFnZV91bmtub3duX2NvdW50XG4gICAgIGZyb20gZmFjZV9zdGF0c19kYWlseVxuICAgICB3aGVyZSAke2F0dHJpYnV0ZVdoZXJlfVxuICAgICBncm91cCBieSBjaGFubmVsX25vYCxcbiAgICBhdHRyaWJ1dGVQYXJhbXNcbiAgKTtcblxuICBjb25zdCBjaGFubmVsTWFwID0gbmV3IE1hcDxcbiAgICBudW1iZXIsXG4gICAge1xuICAgICAgcGVvcGxlSW46IG51bWJlcjtcbiAgICAgIHBlb3BsZU91dDogbnVtYmVyO1xuICAgICAgZmFjZUV2ZW50czogbnVtYmVyO1xuICAgICAgZmFjZXNEZXRlY3RlZDogbnVtYmVyO1xuICAgICAgZ2VuZGVyOiB7IG1hbGU6IG51bWJlcjsgZmVtYWxlOiBudW1iZXI7IHVua25vd246IG51bWJlciB9O1xuICAgICAgYWdlOiB7IGF2ZzogbnVtYmVyIHwgbnVsbCB9O1xuICAgICAgZ2xhc3NlczogeyB5ZXM6IG51bWJlcjsgbm86IG51bWJlcjsgdW5rbm93bjogbnVtYmVyIH07XG4gICAgICBsYXN0RXZlbnRBdDogc3RyaW5nIHwgbnVsbDtcbiAgICB9XG4gID4oKTtcblxuICBmb3IgKGNvbnN0IHJvdyBvZiBwZW9wbGVSb3dzLnJvd3MpIHtcbiAgICBjb25zdCBjaGFubmVsTm8gPSBOdW1iZXIocm93LmNoYW5uZWxfbm8pO1xuICAgIGNoYW5uZWxNYXAuc2V0KGNoYW5uZWxObywge1xuICAgICAgcGVvcGxlSW46IE51bWJlcihyb3cucGVvcGxlX2luID8/IDApLFxuICAgICAgcGVvcGxlT3V0OiBOdW1iZXIocm93LnBlb3BsZV9vdXQgPz8gMCksXG4gICAgICBmYWNlRXZlbnRzOiAwLFxuICAgICAgZmFjZXNEZXRlY3RlZDogMCxcbiAgICAgIGdlbmRlcjogeyBtYWxlOiAwLCBmZW1hbGU6IDAsIHVua25vd246IDAgfSxcbiAgICAgIGFnZTogeyBhdmc6IG51bGwgfSxcbiAgICAgIGdsYXNzZXM6IHsgeWVzOiAwLCBubzogMCwgdW5rbm93bjogMCB9LFxuICAgICAgbGFzdEV2ZW50QXQ6IHJvdy5sYXN0X3Blb3BsZV9ldmVudCA/IG5ldyBEYXRlKHJvdy5sYXN0X3Blb3BsZV9ldmVudCkudG9JU09TdHJpbmcoKSA6IG51bGxcbiAgICB9KTtcbiAgfVxuXG4gIGZvciAoY29uc3Qgcm93IG9mIGZhY2VSb3dzLnJvd3MpIHtcbiAgICBjb25zdCBjaGFubmVsTm8gPSBOdW1iZXIocm93LmNoYW5uZWxfbm8pO1xuICAgIGNvbnN0IGV4aXN0aW5nID0gY2hhbm5lbE1hcC5nZXQoY2hhbm5lbE5vKSA/PyB7XG4gICAgICBwZW9wbGVJbjogMCxcbiAgICAgIHBlb3BsZU91dDogMCxcbiAgICAgIGZhY2VFdmVudHM6IDAsXG4gICAgICBmYWNlc0RldGVjdGVkOiAwLFxuICAgICAgZ2VuZGVyOiB7IG1hbGU6IDAsIGZlbWFsZTogMCwgdW5rbm93bjogMCB9LFxuICAgICAgYWdlOiB7IGF2ZzogbnVsbCB9LFxuICAgICAgZ2xhc3NlczogeyB5ZXM6IDAsIG5vOiAwLCB1bmtub3duOiAwIH0sXG4gICAgICBsYXN0RXZlbnRBdDogbnVsbFxuICAgIH07XG4gICAgY29uc3QgbGFzdEZhY2UgPSByb3cubGFzdF9mYWNlX2V2ZW50ID8gbmV3IERhdGUocm93Lmxhc3RfZmFjZV9ldmVudCkudG9JU09TdHJpbmcoKSA6IG51bGw7XG4gICAgY2hhbm5lbE1hcC5zZXQoY2hhbm5lbE5vLCB7XG4gICAgICBwZW9wbGVJbjogZXhpc3RpbmcucGVvcGxlSW4sXG4gICAgICBwZW9wbGVPdXQ6IGV4aXN0aW5nLnBlb3BsZU91dCxcbiAgICAgIGZhY2VFdmVudHM6IGV4aXN0aW5nLmZhY2VFdmVudHMsXG4gICAgICBmYWNlc0RldGVjdGVkOiBleGlzdGluZy5mYWNlc0RldGVjdGVkLFxuICAgICAgZ2VuZGVyOiBleGlzdGluZy5nZW5kZXIsXG4gICAgICBhZ2U6IGV4aXN0aW5nLmFnZSxcbiAgICAgIGdsYXNzZXM6IGV4aXN0aW5nLmdsYXNzZXMsXG4gICAgICBsYXN0RXZlbnRBdDogZXhpc3RpbmcubGFzdEV2ZW50QXQgfHwgbGFzdEZhY2VcbiAgICB9KTtcbiAgfVxuXG4gIGZvciAoY29uc3Qgcm93IG9mIGF0dHJpYnV0ZVJvd3Mucm93cykge1xuICAgIGNvbnN0IGNoYW5uZWxObyA9IE51bWJlcihyb3cuY2hhbm5lbF9ubyk7XG4gICAgY29uc3QgZXhpc3RpbmcgPSBjaGFubmVsTWFwLmdldChjaGFubmVsTm8pID8/IHtcbiAgICAgIHBlb3BsZUluOiAwLFxuICAgICAgcGVvcGxlT3V0OiAwLFxuICAgICAgZmFjZUV2ZW50czogMCxcbiAgICAgIGZhY2VzRGV0ZWN0ZWQ6IDAsXG4gICAgICBnZW5kZXI6IHsgbWFsZTogMCwgZmVtYWxlOiAwLCB1bmtub3duOiAwIH0sXG4gICAgICBhZ2U6IHsgYXZnOiBudWxsIH0sXG4gICAgICBnbGFzc2VzOiB7IHllczogMCwgbm86IDAsIHVua25vd246IDAgfSxcbiAgICAgIGxhc3RFdmVudEF0OiBudWxsXG4gICAgfTtcbiAgICBjb25zdCBjaGlsZCA9IE51bWJlcihyb3cuY2hpbGRfY291bnQgPz8gMCk7XG4gICAgY29uc3QgdGVlbiA9IE51bWJlcihyb3cudGVlbl9jb3VudCA/PyAwKTtcbiAgICBjb25zdCB5b3VuZyA9IE51bWJlcihyb3cueW91bmdfY291bnQgPz8gMCk7XG4gICAgY29uc3QgbWlkZGxlID0gTnVtYmVyKHJvdy5taWRkbGVfY291bnQgPz8gMCk7XG4gICAgY29uc3Qgc2VuaW9yID0gTnVtYmVyKHJvdy5zZW5pb3JfY291bnQgPz8gMCk7XG4gICAgY29uc3Qga25vd25BZ2VzID0gY2hpbGQgKyB0ZWVuICsgeW91bmcgKyBtaWRkbGUgKyBzZW5pb3I7XG4gICAgY29uc3QgYXZnQWdlID1cbiAgICAgIGtub3duQWdlcyA+IDBcbiAgICAgICAgPyAoY2hpbGQgKiA2ICsgdGVlbiAqIDE2ICsgeW91bmcgKiAzMCArIG1pZGRsZSAqIDUwICsgc2VuaW9yICogNzApIC8ga25vd25BZ2VzXG4gICAgICAgIDogbnVsbDtcbiAgICBjb25zdCBmYWNlc1RvdGFsID0gTnVtYmVyKHJvdy5mYWNlc190b3RhbCA/PyAwKTtcbiAgICBjaGFubmVsTWFwLnNldChjaGFubmVsTm8sIHtcbiAgICAgIC4uLmV4aXN0aW5nLFxuICAgICAgZmFjZUV2ZW50czogZmFjZXNUb3RhbCxcbiAgICAgIGZhY2VzRGV0ZWN0ZWQ6IGZhY2VzVG90YWwsXG4gICAgICBnZW5kZXI6IHtcbiAgICAgICAgbWFsZTogTnVtYmVyKHJvdy5tYWxlX2NvdW50ID8/IDApLFxuICAgICAgICBmZW1hbGU6IE51bWJlcihyb3cuZmVtYWxlX2NvdW50ID8/IDApLFxuICAgICAgICB1bmtub3duOiBOdW1iZXIocm93LmdlbmRlcl91bmtub3duID8/IDApXG4gICAgICB9LFxuICAgICAgYWdlOiB7IGF2ZzogYXZnQWdlIH0sXG4gICAgICBnbGFzc2VzOiB7XG4gICAgICAgIHllczogTnVtYmVyKHJvdy5nbGFzc2VzX3llcyA/PyAwKSxcbiAgICAgICAgbm86IE51bWJlcihyb3cuZ2xhc3Nlc19ubyA/PyAwKSxcbiAgICAgICAgdW5rbm93bjogTnVtYmVyKHJvdy5nbGFzc2VzX3Vua25vd24gPz8gMClcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgb2s6IHRydWUsXG4gICAgc3RhdHM6IHtcbiAgICAgIGlwLFxuICAgICAgbGFzdEV2ZW50QXQ6IG51bGwsXG4gICAgICBjaGFubmVsczogQXJyYXkuZnJvbShjaGFubmVsTWFwLmVudHJpZXMoKSkubWFwKChbY2hhbm5lbElkLCBzdGF0c10pID0+ICh7XG4gICAgICAgIGNoYW5uZWxJZDogU3RyaW5nKGNoYW5uZWxJZCksXG4gICAgICAgIHN0YXRzXG4gICAgICB9KSlcbiAgICB9XG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdldERiUG9vbCIsIkdFVCIsInJlcSIsInVybCIsIlVSTCIsImlwIiwic2VhcmNoUGFyYW1zIiwiZ2V0IiwiZGF5IiwiZGF5UGFyYW0iLCJ0cmltIiwianNvbiIsIm9rIiwiZXJyb3IiLCJzdGF0dXMiLCJkYiIsImNhbWVyYVJlc3VsdCIsInF1ZXJ5IiwiY2FtZXJhSWQiLCJyb3dzIiwiaWQiLCJzdGF0cyIsImxhc3RFdmVudEF0IiwiY2hhbm5lbHMiLCJwZW9wbGVXaGVyZSIsInBlb3BsZVBhcmFtcyIsInBlb3BsZVJvd3MiLCJmYWNlV2hlcmUiLCJmYWNlUGFyYW1zIiwiZmFjZVJvd3MiLCJhdHRyaWJ1dGVXaGVyZSIsImF0dHJpYnV0ZVBhcmFtcyIsImF0dHJpYnV0ZVJvd3MiLCJjaGFubmVsTWFwIiwiTWFwIiwicm93IiwiY2hhbm5lbE5vIiwiTnVtYmVyIiwiY2hhbm5lbF9ubyIsInNldCIsInBlb3BsZUluIiwicGVvcGxlX2luIiwicGVvcGxlT3V0IiwicGVvcGxlX291dCIsImZhY2VFdmVudHMiLCJmYWNlc0RldGVjdGVkIiwiZ2VuZGVyIiwibWFsZSIsImZlbWFsZSIsInVua25vd24iLCJhZ2UiLCJhdmciLCJnbGFzc2VzIiwieWVzIiwibm8iLCJsYXN0X3Blb3BsZV9ldmVudCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImV4aXN0aW5nIiwibGFzdEZhY2UiLCJsYXN0X2ZhY2VfZXZlbnQiLCJjaGlsZCIsImNoaWxkX2NvdW50IiwidGVlbiIsInRlZW5fY291bnQiLCJ5b3VuZyIsInlvdW5nX2NvdW50IiwibWlkZGxlIiwibWlkZGxlX2NvdW50Iiwic2VuaW9yIiwic2VuaW9yX2NvdW50Iiwia25vd25BZ2VzIiwiYXZnQWdlIiwiZmFjZXNUb3RhbCIsImZhY2VzX3RvdGFsIiwibWFsZV9jb3VudCIsImZlbWFsZV9jb3VudCIsImdlbmRlcl91bmtub3duIiwiZ2xhc3Nlc195ZXMiLCJnbGFzc2VzX25vIiwiZ2xhc3Nlc191bmtub3duIiwiQXJyYXkiLCJmcm9tIiwiZW50cmllcyIsIm1hcCIsImNoYW5uZWxJZCIsIlN0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/camera/stats/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getDbPool: () => (/* binding */ getDbPool)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pg__WEBPACK_IMPORTED_MODULE_0__);\n\nlet pool = null;\nfunction getDbPool() {\n    if (!pool) {\n        const connectionString = process.env.DATABASE_URL;\n        if (!connectionString) {\n            throw new Error(\"DATABASE_URL is not set.\");\n        }\n        pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool({\n            connectionString\n        });\n    }\n    return pool;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTBCO0FBRTFCLElBQUlDLE9BQW9CO0FBRWpCLFNBQVNDO0lBQ2QsSUFBSSxDQUFDRCxNQUFNO1FBQ1QsTUFBTUUsbUJBQW1CQyxRQUFRQyxHQUFHLENBQUNDLFlBQVk7UUFDakQsSUFBSSxDQUFDSCxrQkFBa0I7WUFDckIsTUFBTSxJQUFJSSxNQUFNO1FBQ2xCO1FBQ0FOLE9BQU8sSUFBSUQsb0NBQUlBLENBQUM7WUFBRUc7UUFBaUI7SUFDckM7SUFDQSxPQUFPRjtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2FtLWFuYWx5c2lzLy4vbGliL2RiLnRzPzFkZjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUG9vbCB9IGZyb20gXCJwZ1wiO1xuXG5sZXQgcG9vbDogUG9vbCB8IG51bGwgPSBudWxsO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGJQb29sKCkge1xuICBpZiAoIXBvb2wpIHtcbiAgICBjb25zdCBjb25uZWN0aW9uU3RyaW5nID0gcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMO1xuICAgIGlmICghY29ubmVjdGlvblN0cmluZykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiREFUQUJBU0VfVVJMIGlzIG5vdCBzZXQuXCIpO1xuICAgIH1cbiAgICBwb29sID0gbmV3IFBvb2woeyBjb25uZWN0aW9uU3RyaW5nIH0pO1xuICB9XG4gIHJldHVybiBwb29sO1xufVxuIl0sIm5hbWVzIjpbIlBvb2wiLCJwb29sIiwiZ2V0RGJQb29sIiwiY29ubmVjdGlvblN0cmluZyIsInByb2Nlc3MiLCJlbnYiLCJEQVRBQkFTRV9VUkwiLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcamera%2Fstats%2Froute&page=%2Fapi%2Fcamera%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcamera%2Fstats%2Froute.ts&appDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fameralyasin%2FDesktop%2Fcam%20analysis&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();