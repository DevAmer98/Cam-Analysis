"use strict";(()=>{var e={};e.id=879,e.ids=[879],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7600:(e,a,t)=>{t.r(a),t.d(a,{headerHooks:()=>_,originalPathname:()=>y,patchFetch:()=>w,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>f});var n={};t.r(n),t.d(n,{GET:()=>p});var r=t(5419),i=t(9108),o=t(9678),s=t(8070),u=t(7802);async function l(){let e=(0,u.z)(),a=await e.query(`select column_name
     from information_schema.columns
     where table_schema = 'public' and table_name = 'cameras'`),t=new Set(a.rows.map(e=>e.column_name));return{deviceType:t.has("device_type"),zone:t.has("zone"),updatedAt:t.has("updated_at")}}async function p(e){let a=new URL(e.url).searchParams.get("ip");if(!a)return s.Z.json({ok:!1,error:"Missing ip."},{status:400});let t=(0,u.z)(),n=await l(),r=n.deviceType?"device_type":"null::text as device_type",i=n.zone?"zone":"null::text as zone",o=n.updatedAt?"updated_at":"null::timestamptz as updated_at",p=(await t.query(`select id, ip, name, ${r}, ${i}, ${o}
     from cameras where ip = $1`,[a])).rows[0];if(!p)return s.Z.json({ok:!1,error:"Camera not found."},{status:404});let c=(await t.query(`select channel_no, name, zone, features, capabilities
     from channels
     where camera_id = $1
     order by channel_no asc`,[p.id])).rows;return s.Z.json({ok:!0,ip:p.ip,name:p.name,deviceType:p.device_type,zone:p.zone,updatedAt:p.updated_at?new Date(p.updated_at).toISOString():null,channels:c.map(e=>({id:String(e.channel_no),name:"string"==typeof e.name&&e.name.trim()?e.name.trim():`Channel ${e.channel_no}`,zone:e.zone,features:e.features??[],capabilities:e.capabilities??null}))})}let c=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/camera/detail/route",pathname:"/api/camera/detail",filename:"route",bundlePath:"app/api/camera/detail/route"},resolvedPagePath:"/Users/ameralyasin/Desktop/cam analysis/app/api/camera/detail/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:h,headerHooks:_,staticGenerationBailout:f}=c,y="/api/camera/detail/route";function w(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},7802:(e,a,t)=>{t.d(a,{z:()=>i});let n=require("pg"),r=null;function i(){if(!r){let e=process.env.DATABASE_URL;if(!e)throw Error("DATABASE_URL is not set.");r=new n.Pool({connectionString:e})}return r}}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),n=a.X(0,[638,206],()=>t(7600));module.exports=n})();